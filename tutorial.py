#!/usr/bin/env python3
# -*- coding:utf-8 -*-
# Author: kerlomz <kerlomz@gmail.com>
import os
import json
import PIL.Image as pil_image
from config import RecurrentNetwork

charset = "['密', '离', '斜', '渊', '乳', '洽', '抹', '条', '厚', '啸', '圪', '溪', '萱', '区', '剪', '旷', '箩', '清', '太', '拨', '联', '御', '仲', '等', '业', '即', '崩', '岛', '简', '馕', '播', '狡', '莓', '抢', '敌', '受', '随', '充', '嘿', '萨', '矫', '改', '幅', '芒', '庙', '毕', '胞', '本', '泼', '鹏', '酸', '阴', '俦', '牢', '正', '晦', '墟', '哉', '淆', '莠', '袜', '唳', '恭', '溢', '晋', '皲', '瑟', '堡', '轹', '荒', '鸦', '骚', '妪', '雠', '瑚', '茗', '仁', '癖', '诞', '队', '印', '拙', '渔', '榛', '厮', '憨', '杞', '疲', '憾', '叠', '裔', '座', '柱', '佚', '桑', '轾', '滩', '涓', '卖', '胝', '救', '财', '伞', '政', '趾', '麇', '汝', '庵', '衣', '九', '壤', '鲋', '仆', '凑', '妙', '租', '且', '洞', '火', '箫', '涛', '丸', '嫩', '蔗', '钾', '率', '节', '斐', '乏', '少', '咂', '溷', '绯', '截', '分', '胤', '奢', '斧', '沟', '剥', '缝', '寒', '叩', '葵', '午', '微', '礴', '笼', '茸', '闳', '蝴', '璋', '技', '指', '嫉', '铩', '隋', '腹', '崭', '域', '芙', '瘦', '骨', '兽', '菱', '赶', '托', '序', '谕', '厥', '侯', '共', '兄', '驾', '阁', '吠', '宰', '尝', '俄', '辣', '絮', '宕', '拯', '洱', '晒', '跣', '贻', '袖', '凛', '歌', '得', '跎', '姑', '宾', '坐', '蒂', '童', '脖', '殚', '枯', '蝎', '界', '鲸', '困', '焰', '钗', '枇', '雾', '腋', '嚷', '惯', '醋', '再', '秆', '闽', '写', '擢', '棋', '围', '鹅', '篮', '赐', '涕', '牛', '卜', '巢', '劫', '骄', '挥', '阉', '双', '颊', '虽', '弃', '稳', '莺', '庄', '渤', '纡', '关', '叶', '材', '娟', '诵', '掌', '勇', '霸', '荟', '椿', '赦', '乖', '露', '壶', '瓮', '廉', '拇', '旁', '败', '晨', '蹑', '慕', '旱', '卓', '猜', '葩', '健', '把', '穷', '绽', '唱', '腿', '监', '邪', '具', '鲁', '准', '迷', '某', '魃', '奇', '置', '夸', '鹌', '济', '逝', '岭', '腕', '炒', '撞', '恬', '碧', '伪', '是', '濡', '任', '测', '功', '础', '咳', '悟', '速', '岁', '腌', '贝', '攘', '肱', '蛋', '婚', '芝', '哨', '谗', '趋', '万', '床', '琶', '咕', '藤', '升', '按', '府', '面', '徙', '系', '战', '赛', '忙', '带', '培', '顺', '设', '箴', '赈', '羽', '绳', '豕', '桧', '斡', '丰', '榻', '踔', '请', '扁', '防', '绕', '旋', '莼', '盂', '滋', '虚', '轸', '啬', '违', '踞', '镂', '舵', '里', '湘', '冤', '辙', '拔', '窗', '琐', '抗', '革', '哄', '饨', '扑', '户', '褴', '审', '罔', '古', '壁', '塌', '翻', '缓', '董', '罐', '糁', '寐', '琨', '给', '菁', '樽', '策', '拾', '瑰', '搽', '滑', '呢', '振', '未', '贯', '辖', '荧', '穿', '治', '境', '绦', '诽', '馁', '陷', '砣', '跌', '绠', '爱', '尉', '钻', '凯', '也', '戎', '憎', '尽', '砂', '胶', '窃', '偷', '届', '舱', '蚌', '肯', '语', '鲫', '适', '痔', '资', '担', '色', '近', '忆', '扛', '凡', '草', '饔', '票', '佛', '衲', '拜', '渠', '慨', '呼', '衡', '坎', '偃', '螓', '橙', '携', '帅', '院', '藉', '夫', '疯', '薇', '昧', '僵', '壹', '虾', '深', '墙', '迹', '保', '番', '薪', '单', '躁', '惠', '冷', '痕', '酌', '瞩', '摆', '遥', '蚝', '塑', '积', '灿', '婴', '癸', '杜', '绢', '落', '黏', '见', '蛙', '吝', '绷', '桂', '寻', '萃', '品', '羊', '怙', '履', '偕', '蜀', '卒', '背', '此', '忌', '年', '借', '碗', '道', '锷', '瑞', '袅', '身', '转', '看', '沸', '浮', '事', '各', '艾', '卉', '漠', '苏', '碍', '鸟', '沽', '化', '诋', '颁', '饶', '悌', '簧', '箸', '喉', '晾', '银', '其', '隅', '筛', '抑', '藕', '氏', '仔', '骏', '信', '浸', '庚', '加', '纠', '牝', '月', '恐', '徨', '螽', '滇', '免', '处', '雉', '闵', '诲', '驶', '撅', '缛', '谖', '烈', '画', '栅', '涣', '盅', '驷', '吼', '吕', '肆', '喝', '秤', '视', '役', '畏', '埙', '爪', '葭', '送', '基', '吊', '阗', '止', '米', '咏', '疵', '胁', '酷', '删', '娜', '泰', '滴', '锄', '屋', '膝', '忑', '运', '尹', '黥', '聚', '肌', '黛', '趁', '眩', '窝', '陡', '冠', '喇', '南', '块', '颖', '涧', '石', '乎', '减', '馈', '讲', '泡', '灰', '弹', '普', '腑', '稍', '宏', '巫', '鼠', '赵', '凤', '季', '术', '框', '涩', '圆', '垛', '兜', '隘', '轴', '醪', '葡', '迅', '瓤', '套', '支', '愤', '瑶', '症', '他', '闯', '侄', '中', '芟', '推', '苇', '攒', '产', '嘲', '炕', '鳕', '私', '膘', '铿', '缚', '铁', '琼', '扎', '卵', '捩', '疗', '英', '建', '赢', '迈', '演', '俗', '玩', '蓑', '欧', '巴', '罪', '悲', '摄', '优', '营', '蹊', '达', '簸', '鹿', '疚', '狰', '迄', '下', '历', '绶', '读', '尾', '斫', '握', '对', '竿', '蛮', '邂', '劈', '款', '狞', '编', '茭', '索', '绣', '歹', '溺', '酚', '蓼', '壕', '件', '瓯', '搬', '苗', '余', '挪', '诬', '徐', '势', '峡', '璞', '配', '擐', '刍', '遭', '惜', '栉', '停', '针', '郢', '冀', '橱', '楔', '搴', '玲', '日', '棱', '缎', '乍', '谓', '贫', '隳', '膳', '唯', '筹', '勤', '母', '尼', '礼', '宜', '躯', '殆', '贵', '怪', '耗', '舞', '芎', '匝', '粤', '孕', '幻', '消', '梯', '乔', '介', '饲', '梭', '扭', '揎', '直', '透', '姚', '仕', '浒', '完', '攸', '槐', '脸', '词', '迦', '饕', '荡', '彩', '努', '囵', '媚', '锤', '坯', '碳', '痛', '缕', '棒', '博', '前', '患', '蜞', '醛', '捏', '勒', '损', '训', '恍', '善', '伟', '呆', '胺', '壳', '晚', '媒', '潘', '鲳', '瞧', '效', '拘', '记', '典', '威', '怨', '韦', '遁', '县', '陵', '筐', '骋', '乙', '宽', '似', '慌', '桥', '艳', '铄', '误', '戟', '扰', '忠', '宝', '曙', '东', '卯', '偶', '自', '荻', '碰', '税', '窍', '掘', '螂', '罗', '劲', '蝙', '吻', '绨', '附', '朱', '掣', '枞', '决', '淡', '痢', '榈', '卧', '述', '琉', '囤', '伤', '途', '剂', '跫', '煌', '藿', '偬', '就', '销', '砾', '惚', '鸳', '芬', '旦', '盐', '羁', '育', '越', '异', '扇', '气', '慎', '诡', '据', '黍', '意', '挖', '冯', '刷', '弱', '动', '架', '四', '阵', '彝', '猫', '蔽', '份', '食', '陋', '辄', '溜', '键', '顾', '踊', '熘', '撙', '犊', '襟', '笛', '枸', '馆', '蕊', '页', '畅', '芯', '瘠', '沏', '揠', '莽', '挹', '寞', '漓', '喷', '册', '舌', '方', '习', '仿', '肝', '帧', '柄', '无', '帐', '逛', '帮', '匹', '脐', '郊', '袂', '詹', '陌', '短', '渺', '迭', '职', '康', '髯', '廊', '券', '敦', '沉', '售', '档', '鬃', '郸', '莉', '因', '魔', '赠', '拣', '静', '仍', '碎', '寂', '韧', '村', '段', '破', '剔', '纬', '确', '折', '我', '敢', '缟', '魏', '构', '帆', '筒', '炽', '掂', '赡', '奥', '瘁', '出', '戴', '饺', '琴', '杷', '馋', '诏', '专', '启', '朝', '倾', '亏', '逊', '倘', '奋', '味', '煽', '鲇', '遇', '召', '樨', '娇', '低', '昨', '苍', '渣', '澈', '尻', '茶', '详', '乘', '计', '含', '艺', '翁', '格', '伶', '苹', '酒', '裘', '国', '硕', '橡', '殃', '喻', '靛', '务', '欣', '亨', '萝', '剩', '依', '泥', '挂', '豁', '杼', '涌', '杳', '晷', '幕', '卫', '能', '哆', '倚', '显', '黼', '夺', '始', '缺', '水', '陶', '蠖', '废', '冒', '歧', '刀', '徽', '电', '扒', '龇', '千', '抵', '玛', '牖', '郐', '烤', '锅', '丘', '螺', '海', '抄', '病', '后', '种', '跋', '姻', '铸', '旌', '巡', '汾', '杰', '啮', '蜂', '椽', '壬', '儒', '旅', '氨', '射', '炸', '莴', '当', '着', '芷', '钓', '驹', '锐', '否', '末', '舆', '掩', '扯', '明', '菠', '荫', '绝', '勃', '纤', '秘', '悬', '蓄', '扣', '甑', '热', '待', '撮', '外', '恼', '辔', '粘', '揪', '神', '傲', '泻', '额', '端', '跨', '穆', '女', '撕', '初', '坊', '寸', '喜', '狮', '爵', '夜', '德', '枚', '纵', '纪', '性', '只', '主', '躬', '相', '聿', '害', '庋', '蚂', '骂', '痴', '仗', '椹', '滚', '寄', '疾', '答', '悖', '豹', '忐', '难', '汗', '祝', '苦', '慈', '臻', '恢', '雹', '诚', '脏', '席', '蒸', '悔', '五', '斤', '霏', '姓', '祖', '投', '灌', '佳', '满', '澹', '绫', '弦', '言', '催', '哈', '唇', '贷', '骊', '萘', '圭', '脑', '恤', '掰', '嘘', '告', '诛', '逆', '吴', '蒡', '属', '藜', '劣', '榫', '瞎', '发', '貌', '诟', '桴', '妆', '痹', '吞', '耘', '枫', '黑', '鞋', '果', '昼', '弛', '炖', '护', '变', '羡', '欢', '尤', '衷', '薮', '锺', '挡', '惹', '弟', '谁', '降', '汪', '导', '苑', '抉', '勾', '雌', '僻', '俱', '掀', '装', '逮', '称', '讪', '徜', '擒', '盒', '鬟', '叟', '缸', '稷', '欲', '削', '矗', '蚍', '男', '竭', '宿', '雀', '堆', '谨', '芭', '淮', '彰', '七', '攻', '靡', '骤', '轰', '窖', '牟', '娉', '舳', '浇', '抒', '恙', '俊', '周', '疼', '沁', '泊', '翅', '警', '赃', '暖', '泽', '篇', '黄', '兼', '墓', '臼', '霁', '渝', '兢', '占', '雳', '蟾', '坑', '衍', '徭', '恋', '擅', '兴', '狱', '蠕', '雏', '螟', '叫', '钿', '趣', '宗', '天', '喊', '抚', '糖', '断', '树', '凭', '罄', '挈', '朋', '希', '弓', '的', '熊', '行', '驰', '填', '儆', '腥', '伏', '谣', '钩', '椎', '恶', '鳄', '概', '嗒', '杯', '易', '欺', '衽', '拼', '手', '荤', '归', '必', '铵', '团', '椟', '雍', '锥', '鹘', '掉', '蚵', '毗', '沼', '穴', '帝', '迪', '湖', '线', '凌', '壮', '若', '骛', '渐', '师', '凸', '斩', '舍', '邱', '夕', '遮', '津', '榨', '孺', '馏', '棍', '虱', '砌', '片', '燃', '祭', '肚', '克', '颠', '何', '邻', '程', '匠', '蒲', '潭', '旎', '栽', '炭', '沤', '则', '辨', '洲', '毡', '影', '晓', '烽', '幌', '蚶', '鲜', '总', '偿', '绩', '梅', '闲', '骧', '甚', '半', '遏', '堕', '毂', '扪', '辱', '两', '汰', '飞', '尕', '瞒', '间', '期', '椒', '薯', '臾', '犀', '帔', '厦', '秋', '嫦', '淘', '庆', '侣', '曾', '咬', '史', '剁', '弥', '嘉', '倒', '点', '桔', '鲞', '时', '幽', '众', '斋', '誉', '夏', '皆', '全', '驱', '迥', '挝', '贾', '漏', '恃', '协', '跑', '武', '秕', '秽', '刈', '樵', '墨', '冥', '谢', '办', '慧', '磨', '邀', '知', '棠', '拆', '雨', '幸', '今', '残', '哮', '哑', '皓', '倍', '皋', '都', '晃', '询', '仪', '涎', '驳', '亡', '脱', '戳', '向', '谐', '钢', '鳞', '饱', '嫂', '璧', '苟', '毖', '缮', '膀', '脯', '珑', '蝇', '迩', '裾', '缩', '署', '赋', '隙', '版', '布', '卤', '帏', '督', '为', '录', '终', '容', '邯', '志', '风', '熟', '蓬', '译', '璃', '衢', '诮', '孝', '香', '蔓', '价', '铀', '揖', '库', '戏', '枝', '慷', '陟', '慢', '飧', '封', '饽', '篷', '灵', '腩', '错', '陨', '潇', '故', '量', '壑', '妹', '痒', '过', '舛', '鬓', '胆', '蝶', '抬', '援', '白', '锦', '孤', '次', '圈', '医', '涮', '冈', '蛾', '士', '赤', '炬', '需', '肢', '呈', '累', '盈', '捐', '蛀', '粥', '隆', '估', '纹', '付', '呕', '足', '婢', '阶', '倥', '响', '屹', '聋', '抠', '萌', '槿', '傥', '寅', '糕', '齐', '刽', '生', '列', '膻', '蛳', '蜜', '论', '橐', '锵', '浙', '粉', '叉', '谋', '泉', '宅', '映', '比', '绿', '箪', '纯', '弗', '噜', '鸱', '园', '鸥', '汽', '贞', '磕', '胄', '弈', '沅', '杖', '垦', '盏', '澜', '汤', '守', '谴', '揉', '韩', '沂', '耕', '逅', '捣', '略', '罢', '责', '真', '檗', '辞', '领', '夷', '讷', '哥', '稠', '恣', '桌', '啉', '艰', '肉', '姿', '亮', '偎', '翔', '葚', '十', '镞', '诘', '饯', '牦', '场', '翠', '彤', '聆', '驻', '摩', '筑', '陪', '颓', '柠', '婿', '智', '砍', '砻', '零', '邑', '以', '辑', '贼', '批', '萄', '吉', '葫', '狐', '纸', '恩', '聊', '合', '棘', '一', '活', '帚', '造', '荪', '祷', '哭', '龄', '檀', '渭', '蹈', '坡', '忧', '橄', '暑', '司', '用', '涵', '芜', '客', '吐', '馥', '币', '捆', '矢', '虐', '情', '妖', '鱿', '将', '雪', '内', '札', '李', '伊', '咸', '蘑', '怒', '仅', '圃', '才', '硎', '除', '云', '河', '稚', '叱', '北', '盖', '甘', '闺', '哀', '蒿', '磬', '沿', '摘', '饴', '角', '括', '蓝', '妃', '搓', '竹', '鹦', '厘', '嗓', '什', '俯', '浓', '严', '般', '由', '硫', '脍', '袱', '塞', '栋', '毁', '渴', '辰', '籍', '豚', '踏', '甸', '榄', '哇', '连', '室', '沦', '举', '暇', '谊', '溴', '竟', '福', '吮', '胫', '鸠', '褐', '稀', '侔', '与', '游', '肘', '叨', '官', '搭', '槁', '拢', '耶', '远', '竞', '察', '窄', '蕨', '顿', '隔', '鼻', '陆', '舰', '茉', '雷', '碟', '箔', '吾', '窥', '孜', '宋', '旧', '冻', '旰', '光', '戒', '臆', '腮', '瘢', '芪', '眯', '荜', '浦', '尘', '堑', '统', '逍', '家', '尺', '激', '镁', '晕', '廓', '汇', '收', '疮', '吃', '稿', '笔', '爽', '鲎', '承', '艇', '殿', '盔', '馔', '问', '蟒', '溶', '氐', '实', '阙', '酥', '笠', '叛', '俐', '樟', '阖', '筵', '鹤', '钙', '缠', '常', '滂', '曝', '鲍', '蔬', '尊', '红', '翩', '存', '昔', '乌', '谎', '蜚', '定', '休', '酶', '碣', '淋', '愿', '芳', '噬', '谬', '钵', '猎', '裁', '拄', '谜', '披', '酯', '丛', '束', '灼', '粑', '愉', '判', '贡', '刳', '羹', '狸', '灭', '徘', '歃', '坠', '梦', '油', '烩', '缘', '开', '抱', '劝', '煨', '换', '春', '熙', '盟', '书', '她', '伺', '涸', '企', '峰', '暂', '讳', '辈', '谷', '峦', '吏', '毙', '摔', '驴', '闭', '绍', '章', '阔', '朽', '敛', '肋', '物', '景', '喱', '伎', '纷', '襄', '犬', '摧', '焉', '厕', '狈', '秉', '予', '昌', '哲', '趄', '钠', '嘶', '嫠', '亘', '原', '茹', '匡', '勿', '牍', '撒', '管', '抛', '认', '旗', '茯', '扬', '函', '帛', '坦', '梳', '峥', '鉴', '铭', '瀛', '凶', '曳', '苞', '悍', '惶', '奈', '玻', '熔', '罴', '咀', '赏', '麝', '诱', '侉', '缤', '昭', '蜡', '赅', '仰', '矛', '几', '谦', '祥', '寨', '荠', '植', '衅', '菩', '戛', '橘', '厌', '尔', '俎', '吸', '孽', '展', '权', '漱', '公', '烧', '妍', '嗟', '鱼', '轩', '啄', '险', '隐', '潢', '临', '毋', '输', '郭', '纱', '感', '笃', '瞠', '叹', '柔', '忻', '怡', '老', '颤', '例', '唐', '诎', '稔', '茼', '采', '美', '君', '掠', '井', '赎', '纽', '起', '球', '佩', '谈', '引', '擦', '抓', '申', '阅', '结', '之', '员', '嗫', '崖', '啼', '试', '膜', '鞠', '揽', '丈', '迟', '陈', '鸣', '卷', '荞', '屈', '没', '省', '狂', '突', '切', '窜', '潮', '细', '释', '籽', '胃', '捉', '撩', '耿', '宛', '鳝', '谑', '在', '铢', '咽', '焦', '喧', '屠', '菲', '不', '蔫', '彻', '军', '癣', '庞', '釜', '甫', '啖', '柳', '钟', '岩', '庐', '奏', '螃', '秃', '锋', '松', '撵', '祜', '擎', '孟', '重', '浅', '浊', '胡', '赖', '贪', '辽', '高', '拒', '骗', '鄙', '亦', '辟', '屦', '惧', '悱', '肠', '芡', '践', '胜', '朴', '嶂', '腐', '乞', '霆', '浩', '冗', '笑', '蟠', '唾', '韵', '签', '挨', '辉', '炙', '髓', '辕', '刚', '谤', '顽', '谩', '韬', '织', '念', '湾', '穰', '绪', '息', '枣', '侈', '啤', '径', '蹄', '蹇', '雁', '仙', '涪', '森', '亚', '睫', '蚕', '案', '咯', '膨', '要', '骥', '瞪', '荷', '苛', '沈', '踵', '姜', '源', '瞅', '矣', '狼', '蘸', '宵', '屑', '薄', '烀', '识', '黎', '郑', '荐', '上', '洋', '魄', '综', '梢', '溲', '船', '快', '空', '像', '描', '钱', '弩', '辅', '浆', '亢', '寿', '廷', '擂', '瓣', '增', '疑', '盾', '项', '丑', '友', '鳜', '逢', '怜', '左', '层', '瞑', '伍', '侮', '弧', '查', '诸', '类', '契', '丝', '冶', '卢', '兆', '波', '堪', '珊', '厝', '绰', '穗', '坤', '嘎', '伐', '楂', '润', '齿', '思', '甲', '揆', '莹', '耪', '替', '桉', '贩', '轻', '锯', '澄', '暮', '诈', '蝠', '彼', '绥', '茁', '江', '珥', '陮', '裕', '偏', '新', '蜇', '揣', '拌', '频', '奉', '豉', '栖', '亲', '剖', '多', '宇', '拐', '醒', '岑', '益', '柯', '衫', '炝', '哺', '眸', '听', '黔', '姬', '义', '宁', '题', '侍', '沫', '锱', '骑', '诺', '藩', '崇', '涯', '验', '蠹', '蕴', '锃', '放', '闪', '入', '淹', '派', '被', '飘', '俭', '侗', '补', '血', '便', '泗', '臂', '菽', '贰', '每', '串', '个', '耻', '人', '玉', '塔', '佐', '戮', '挽', '旭', '瘴', '狠', '疆', '奴', '匀', '居', '杨', '乾', '栈', '麦', '哗', '钳', '颔', '蜃', '猴', '韭', '鸭', '著', '星', '作', '篪', '巧', '玷', '磷', '疥', '愦', '质', '市', '课', '挠', '汹', '航', '脾', '富', '堂', '讼', '蒙', '雄', '楹', '名', '组', '氰', '暗', '紧', '刘', '紫', '素', '肿', '漆', '罕', '韶', '可', '拳', '娱', '莫', '洪', '贸', '集', '腰', '匮', '涨', '早', '住', '倦', '态', '跬', '吭', '茄', '忿', '蕃', '烫', '玄', '歉', '操', '黜', '盎', '川', '捕', '桀', '虎', '巍', '代', '让', '掬', '岳', '链', '馒', '胸', '倩', '弊', '拖', '烂', '形', '龙', '法', '谭', '麻', '饮', '维', '诳', '征', '伉', '愚', '晏', '懦', '楼', '刨', '劳', '互', '头', '觅', '怯', '扮', '悯', '闷', '馨', '杆', '纭', '措', '醯', '苋', '蕾', '慑', '蚊', '砺', '毫', '惕', '倭', '榱', '亥', '懈', '殒', '潦', '舶', '腔', '焙', '范', '冕', '疙', '凉', '闰', '糍', '兔', '沱', '涉', '镇', '蟆', '旺', '令', '熏', '煞', '醉', '喹', '淖', '瓢', '忍', '差', '瓜', '调', '缄', '羞', '献', '进', '长', '湛', '摸', '琢', '然', '找', '捞', '象', '舜', '珍', '议', '枭', '鹄', '解', '郁', '标', '戚', '刊', '嚼', '狗', '猷', '宴', '挞', '圣', '夹', '粗', '器', '姹', '砖', '煮', '危', '杏', '敏', '所', '浃', '昏', '惨', '宪', '做', '梁', '首', '股', '斑', '大', '瓶', '琪', '朵', '埒', '绎', '硝', '取', '麟', '钜', '循', '埴', '宣', '捧', '刑', '延', '矜', '泮', '观', '肤', '鹃', '买', '皇', '魁', '睐', '摇', '谛', '唤', '睹', '豪', '弄', '软', '矾', '乱', '急', '樱', '诗', '氽', '秀', '藻', '经', '簪', '斗', '距', '葛', '览', '萤', '淬', '猕', '搔', '坏', '择', '瞳', '烁', '孙', '粝', '杭', '厨', '簇', '凰', '焚', '尖', '妇', '徒', '睛', '钉', '悦', '垂', '勉', '氧', '拽', '绮', '筋', '商', '慰', '嵘', '椰', '刻', '烯', '萦', '脚', '肥', '皮', '苓', '脂', '漾', '冲', '嫁', '夙', '虑', '绵', '求', '抟', '幄', '榜', '液', '靖', '蹦', '莎', '网', '磊', '惊', '峭', '讯', '柿', '沓', '坚', '鸿', '律', '楚', '凄', '烹', '槟', '绌', '饥', '百', '缰', '踪', '丁', '去', '畴', '薏', '妄', '备', '裤', '超', '芋', '排', '通', '压', '峨', '茫', '苕', '茅', '亭', '蜗', '搠', '路', '冰', '整', '阪', '腻', '棕', '馄', '号', '菇', '啡', '鹑', '贴', '躇', '迁', '服', '预', '梓', '掐', '应', '铰', '追', '从', '埋', '琵', '房', '舒', '级', '失', '譬', '龈', '嘴', '荆', '恕', '碱', '固', '殊', '腾', '现', '岗', '糜', '逐', '铜', '泣', '添', '泾', '久', '扶', '勋', '并', '蓉', '修', '盆', '磺', '根', '篙', '雕', '寓', '赴', '龟', '垒', '悠', '鲨', '枕', '箕', '厄', '捶', '掷', '稼', '朗', '涅', '棉', '珠', '苯', '稽', '沪', '泄', '检', '汉', '获', '龋', '糙', '褛', '翡', '鳗', '注', '溯', '祁', '胼', '樊', '或', '西', '淳', '孚', '乡', '枘', '杂', '汲', '馍', '拍', '鼓', '愧', '梨', '均', '诃', '袭', '玫', '世', '马', '如', '融', '拱', '劬', '模', '鞍', '考', '倔', '魂', '阳', '但', '缪', '怀', '裂', '元', '蟑', '蝉', '返', '遂', '眠', '醚', '复', '挚', '砸', '贬', '仞', '亩', '及', '铤', '镳', '裙', '蛏', '成', '伛', '卡', '颅', '符', '殉', '搏', '极', '污', '许', '粱', '谄', '肃', '槛', '烟', '荸', '揭', '青', '顶', '讴', '状', '萧', '瞽', '回', '靠', '探', '厉', '嬉', '流', '惑', '而', '蹉', '敲', '析', '曹', '敷', '既', '利', '平', '羔', '奎', '尧', '姐', '挫', '贺', '拂', '燎', '声', '牵', '茵', '霞', '幼', '酱', '兵', '争', '滥', '林', '爬', '芸', '旖', '锣', '默', '倪', '音', '柏', '筲', '耆', '阑', '敝', '祸', '洛', '奖', '授', '煎', '泪', '非', '粟', '促', '裸', '嚣', '胭', '磐', '荔', '鳎', '特', '脆', '苔', '拿', '咤', '吹', '社', '沙', '曜', '械', '击', '载', '拥', '招', '厅', '炊', '豇', '藓', '赧', '蛤', '霜', '烘', '创', '力', '曼', '舄', '酰', '搅', '虬', '嫡', '峻', '址', '榴', '群', '囚', '垣', '蟹', '耀', '表', '净', '腊', '侠', '屡', '位', '阿', '澎', '步', '胯', '鲤', '甩', '晖', '潸', '坍', '伸', '纳', '另', '旨', '涂', '箱', '核', '粒', '菌', '话', '浏', '熬', '钝', '咫', '褒', '蔚', '鳌', '懿', '说', '熠', '臭', '哩', '丧', '往', '恒', '值', '囊', '先', '饰', '翥', '葬', '驯', '沾', '料', '嗑', '喘', '锁', '膏', '貉', '际', '校', '幡', '沐', '选', '咎', '帕', '薰', '毅', '糯', '谔', '鳅', '盘', '店', '尚', '算', '寡', '脊', '传', '倨', '命', '铺', '凳', '撼', '州', '制', '挤', '阐', '糌', '傍', '撑', '良', '绸', '鸾', '打', '逾', '倡', '浴', '陕', '昂', '硬', '鸯', '柚', '涤', '沥', '雅', '较', '谀', '却', '永', '彦', '图', '药', '了', '伴', '来', '持', '焖', '蕉', '候', '绚', '逞', '遵', '酬', '惭', '姆', '想', '教', '精', '皂', '殷', '剑', '示', '享', '萍', '馀', '惟', '裳', '究', '岸', '忘', '旄', '局', '鸽', '沃', '会', '逸', '茂', '牧', '避', '虢', '秒', '牡', '包', '匿', '僭', '孔', '饼', '忽', '噎', '颐', '潜', '盼', '饵', '嫌', '池', '费', '安', '怕', '娥', '踌', '散', '翼', '潼', '边', '施', '竖', '遐', '邓', '拉', '膺', '续', '鹊', '蛇', '瑜', '枳', '誊', '嫣', '颂', '甜', '枥', '络', '猛', '轿', '邦', '槽', '邮', '委', '骸', '晴', '耐', '挟', '鸡', '侧', '颈', '到', '颜', '瓦', '霄', '芽', '镌', '糠', '氢', '濯', '桃', '拓', '豫', '菜', '苫', '伦', '荣', '曲', '镒', '昃', '楠', '醇', '齑', '砚', '拊', '莜', '京', '灶', '鲐', '金', '胎', '侵', '机', '盲', '莱', '炮', '假', '证', '耳', '疤', '钧', '徵', '酿', '悉', '跃', '须', '闻', '瘗', '养', '规', '别', '移', '舟', '徊', '衾', '徇', '弘', '茧', '嘛', '刮', '缔', '烦', '叙', '袍', '饧', '缁', '躺', '裹', '障', '渡', '染', '遑', '徉', '鲈', '炫', '遣', '罚', '蠡', '戾', '民', '醅', '萎', '宠', '舐', '桐', '蔼', '戈', '底', '蒜', '氯', '栗', '匍', '张', '猬', '迎', '样', '柴', '焕', '驼', '轶', '檬', '枉', '庶', '犯', '搜', '于', '庸', '螳', '执', '温', '灾', '箧', '葱', '蚓', '歪', '粢', '至', '禁', '鸢', '爆', '睦', '帜', '睡', '汁', '奔', '街', '挺', '秦', '瘩', '僮', '歇', '巾', '倜', '宫', '数', '懒', '骇', '挑', '纶', '文', '泌', '鹜', '遗', '横', '屯', '走', '荛', '肴', '矩', '环', '烛', '理', '掇', '反', '助', '鹉', '乃', '报', '货', '央', '垢', '佯', '车', '咆', '划', '农', '炉', '硅', '登', '衰', '畜', '捷', '耙', '钥', '交', '攀', '馅', '讨', '纲', '肾', '喙', '嚎', '铝', '还', '咖', '饭', '强', '蛎', '霖', '玑', '望', '芹', '媲', '觌', '扼', '犹', '吟', '禾', '锻', '酣', '芥', '峙', '虞', '扫', '瞬', '皎', '粲', '震', '餐', '滓', '盗', '度', '鞭', '田', '疏', '傅', '评', '梗', '稻', '芦', '衔', '繁', '眉', '拭', '斟', '猿', '好', '负', '灸', '咄', '沧', '盛', '族', '巷', '城', '尙', '秣', '婷', '轨', '科', '愁', '约', '藏', '缨', '脉', '右', '镶', '窑', '虮', '练', '留', '体', '和', '凫', '梧', '铃', '况', '糟', '冬', '踢', '照', '轮', '字', '有', '覆', '鑫', '酮', '聪', '丙', '淀', '翘', '醮', '卑', '惮', '靴', '毛', '匪', '赫', '昆', '悛', '泛', '允', '魅', '者', '刃', '禄', '酪', '栎', '洁', '牌', '砥', '贤', '漂', '拈', '聩', '铅', '刿', '研', '刺', '同', '肺', '帼', '漫', '榆', '豆', '蜉', '瑕', '禽', '割', '燕', '访', '剜', '炼', '继', '叵', '烙', '帙', '噪', '板', '句', '粽', '迸', '混', '灯', '琳', '更', '浑', '鹰', '学', '箭', '肩', '提', '妒', '铛', '斯', '触', '誓', '致', '镜', '仇', '迫', '丽', '供', '讥', '丹', '弯', '糊', '恨', '莞', '霹', '罩', '敖', '帽', '立', '笋', '祛', '蹙', '炎', '接', '卦', '跳', '腼', '惩', '退', '账', '赘', '仓', '茴', '乐', '馓', '辛', '柑', '心', '洗', '瑙', '寝', '晶', '眦', '鼎', '最', '式', '瞻', '阻', '婺', '木', '蚁', '凿', '沛', '咋', '愈', '参', '屏', '粮', '牙', '虫', '诅', '苡', '莲', '目', '衿', '第', '囫', '榕', '骈', '兰', '地', '凝', '妻', '莳', '励', '磅', '野', '使', '楞', '婶', '副', '辩', '伯', '驭', '班', '帷', '株', '匣', '鹭', '抽', '咨', '花', '粹', '敬', '谏', '储', '繇', '部', '巨', '坨', '眼', '耸', '酉', '豌', '贱', '枢', '浪', '庭', '谅', '锌', '锰', '郎', '酵', '虹']"
network = RecurrentNetwork.BSRU

trains_path = [
    r"D:\TrainSet\***",
]

model = """
# ModelName: Corresponding to the model file in the model directory,
# - such as YourModelName.pb, fill in YourModelName here.
# CharSet: Provides a default optional built-in solution:
# - [ALPHANUMERIC, ALPHANUMERIC_LOWER, ALPHANUMERIC_UPPER,
# -- NUMERIC, ALPHABET_LOWER, ALPHABET_UPPER, ALPHABET, ALPHANUMERIC_LOWER_MIX_CHINESE_3500]
# - Or you can use your own customized character set like: ['a', '1', '2'].
# CharExclude: CharExclude should be a list, like: ['a', '1', '2']
# - which is convenient for users to freely combine character sets.
# - If you don't want to manually define the character set manually,
# - you can choose a built-in character set
# - and set the characters to be excluded by CharExclude parameter.
Model:
  Sites: [
  ]
  ModelName: @model_name
  ModelType: @size_str
  CharSet: @charset
  CharExclude: []
  CharReplace: {}
  ImageWidth: @width
  ImageHeight: @height

# Binaryzation: [-1: Off, >0 and < 255: On].
# Smoothing: [-1: Off, >0: On].
# Blur: [-1: Off, >0: On].
# Resize: [WIDTH, HEIGHT]
# - If the image size is too small, the training effect will be poor and you need to zoom in.
Pretreatment:
  Binaryzation: -1
  Smoothing: -1
  Blur: -1
  Resize: @resize

Trains:
#  TrainsPath: './dataset/@model_name_trains.tfrecords'
#  TestPath: './dataset/@model_name_test.tfrecords'
  TrainsPath: @trains_path
  
"""

# - [ALPHANUMERIC, ALPHANUMERIC_LOWER, ALPHANUMERIC_UPPER,
# -- NUMERIC, ALPHABET_LOWER, ALPHABET_UPPER, ALPHABET, ALPHANUMERIC_LOWER_MIX_CHINESE_3500]

trains_path = [i.replace("\\", "/") for i in trains_path]
file_name = os.listdir(trains_path[0])[0]
size = pil_image.open(os.path.join(trains_path[0], file_name)).size

width = size[0]
height = size[1]
size_str = "{}x{}".format(width, height)
if width > 180 or width <= 120:
    r_height = int(height * 150 / width)
else:
    r_height = height
resize = "[{}, {}]".format(width if r_height == height else 150, r_height)

model_name = 'sell-mix-CNN5{}-{}'.format(network, size_str)
trains_path = json.dumps(trains_path, ensure_ascii=False).replace("]", "  ]")
result = model.replace("@trains_path", trains_path).replace("@model_name", model_name).replace("@resize",
                                                                                               resize).replace(
    "@size_str", size_str).replace("@width", str(width)).replace("@height", str(height)).replace("@charset", charset)
print(result)

with open("model.yaml".format(size_str), "w", encoding="utf8") as f:
    f.write(result)

from make_dataset import run
from trains import main

run()
with open("model.yaml".format(size_str), "w", encoding="utf8") as f:
    f.write("\n".join(result.split("\n")[:-3]).replace("#  TrainsPath", "  TrainsPath").replace("#  TestPath",
                                                                                                "  TestPath"))
main(None)
